<!-- Assistant Kybra -->
<div id="chatbot" class="chatbot">
  <div class="chat-header">Assistant Kybra 🤖</div>
  <div id="chatbox" class="chatbox"></div>
  <div class="chat-input-area">
    <input type="text" id="userInput" placeholder="Pose ta question..." />
    <button onclick="sendMessage()">Envoyer</button>
  </div>
</div>

<style>
  .chatbot {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 310px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    z-index: 999;
    font-family: sans-serif;
  }
  .chat-header {
    background: #00b894;
    color: white;
    padding: 12px;
    font-weight: bold;
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    text-align: center;
  }
  .chatbox {
    max-height: 350px;
    overflow-y: auto;
    padding: 10px;
    font-size: 14px;
  }
  .chat-input-area {
    display: flex;
    border-top: 1px solid #ddd;
  }
  #userInput {
    flex: 1;
    padding: 10px;
    border: none;
    outline: none;
    border-bottom-left-radius: 15px;
  }
  button {
    background: #00b894;
    color: white;
    border: none;
    padding: 10px;
    cursor: pointer;
    border-bottom-right-radius: 15px;
  }
  .bot, .user {
    margin: 5px 0;
    padding: 8px 12px;
    border-radius: 20px;
    display: inline-block;
    max-width: 85%;
  }
  .bot {
    background: #f1f1f1;
    color: #2d3436;
  }
  .user {
    background: #dfe6e9;
    align-self: flex-end;
    margin-left: auto;
  }
  .question-button {
    background: #dff9fb;
    border: none;
    margin: 4px 2px;
    padding: 6px 12px;
    border-radius: 18px;
    cursor: pointer;
    font-size: 13px;
  }
</style>

<script>
  const predefinedQuestions = [
    "Quels sont les produits disponibles ?",
    "Comment commander sur Kybra ?",
    "Livrez-vous en dehors de Carrefour ?",
    "Je veux devenir vendeur",
    "Quel est le prix des t-shirts ?",
    "Faites-vous des offres spéciales ?",
    "Comment contacter le service client ?",
    "Qui est Kenny ?",
    "Puis-je avoir une montre gratuite ?",
    "Est-ce que l’application est en développement ?",
    "Parle-moi de Kybra",
    "Quels sont vos modes de paiement ?",
    "Avez-vous des sacs à main ?",
    "Combien coûte le casque Bluetooth ?",
    "Je veux passer une commande maintenant",
    "Pourquoi Kybra s'appelle Kybra ?",
    "Que vend Kybra exactement ?",
    "Est-ce que Kybra est sécurisé ?",
    "Quel est le meilleur produit ?",
    "Peux-tu me faire une blague ?",
    "Qui est ton créateur ?",
    "Tu es une vraie personne ?",
    "Est-ce que je peux te parler tous les jours ?",
    "C’est quoi ce site ?"
  ];

  const responses = {
    "produits": "Nos produits incluent montres, sacs, t-shirts, chaussures, casques, etc. Explore la page d'accueil !",
    "commander": "Clique sur le bouton WhatsApp à côté du produit. Simple et rapide ! 📦",
    "carrefour": "Nous livrons uniquement à Carrefour pour le moment. Mais on s’étend vite !",
    "vendeur": "Pour devenir vendeur, clique ici : https://wa.me/50935196415?text=Je%20veux%20devenir%20vendeur%20sur%20Kybra",
    "t-shirts": "À partir de 1000 HTG, modèles variés disponibles 👕",
    "offres": "Oui, il y a souvent des promotions surprises !",
    "client": "Contactez-nous via WhatsApp au +509 35196415",
    "kenny": "Kenny est le créateur de Kybra… ou peut-être un agent secret ? 😂",
    "gratuite": "Gagne au mini-jeu et c’est peut-être pour toi 😄",
    "développement": "Oui, le site est en développement constant. Merci de faire partie de l'aventure !",
    "kybra": "Kybra est une boutique haïtienne en ligne pour vos achats pratiques 🇭🇹",
    "paiement": "Paiement à la livraison, mobile money bientôt 💵",
    "sacs": "Oui, des sacs stylés à découvrir 👜",
    "casque": "Le casque Bluetooth est à environ 2500 HTG 🎧",
    "commande": "Clique WhatsApp à côté du produit pour commander maintenant ✅",
    "pourquoi": "Bonne question ! C’est le secret de Kenny 😄",
    "que vend": "On vend ce que tu aimes : accessoires, mode, et style 🔥",
    "sécurisé": "Oui ! Tes infos sont protégées. Promis 💡",
    "meilleur": "Chaque client a son préféré, mais les montres cartonnent ⌚",
    "blague": "Pourquoi le sac a rompu avec la montre ? Il en avait assez d’être toujours en retard ! 😂",
    "créateur": "Tu veux des infos sur Kenny ? C’est classified. Mais tu peux acheter pendant que t’attends 😏",
    "vraie": "Je suis un assistant Kybra. Pas humain, mais presque 🧠",
    "parler": "Oui, je suis dispo 24/7. Mais je préfère quand tu commandes quelque chose 😅",
    "c’est quoi": "Ceci est Kybra : ton nouveau réflexe shopping 🇭🇹"
  };

  function sendMessage() {
    const input = document.getElementById("userInput");
    const message = input.value.trim();
    if (!message) return;
    addMessage("user", message);
    input.value = "";

    const matchedKey = Object.keys(responses).find(key =>
      message.toLowerCase().includes(key)
    );

    const reply = matchedKey ? responses[matchedKey] : "Je ne suis pas sûr de comprendre, mais explore notre site ou WhatsApp nous 😅";
    setTimeout(() => {
      addMessage("bot", reply);
      suggestQuestions();
    }, 500);
  }

  function addMessage(sender, text) {
    const box = document.getElementById("chatbox");
    const msg = document.createElement("div");
    msg.className = sender;
    msg.textContent = text;
    box.appendChild(msg);
    box.scrollTop = box.scrollHeight;
  }

  function suggestQuestions() {
    const box = document.getElementById("chatbox");
    const shuffle = [...predefinedQuestions].sort(() => 0.5 - Math.random());
    const limited = shuffle.slice(0, 3);
    limited.forEach(q => {
      const btn = document.createElement("button");
      btn.className = "question-button";
      btn.textContent = q;
      btn.onclick = () => {
        document.getElementById("userInput").value = q;
        sendMessage();
      };
      box.appendChild(btn);
    });
    box.scrollTop = box.scrollHeight;
  }

  window.onload = () => {
    addMessage("bot", "Salut ! Je suis l'assistant Kybra 🤖. Comment puis-je t’aider ?");
    suggestQuestions();
  };
</script>
